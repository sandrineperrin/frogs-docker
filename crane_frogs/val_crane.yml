containers:
  init:
    image: biom_to_tsv:2.1.0
    run:
      volume: ["/root/data:/root"]
      workdir: "/root/out"
      cmd: ["echo", $HOME, "&&","ls", "-l"]
  
  affotu:
    image: affiliation_otu:0.9.0
    run:
      volume: ["/root/data:/root"]
      workdir: "/root/out"
      cmd: ["affiliation_OTU.py", "--input-biom", "../example.biom","--reference", "../db.fasta", "--output-file","affotu.out"]
 
  affstat:
    image: affiliations_stat:1.1.0
    run:
      volume: ["/root/data:/root"]
      workdir: "/root/out"
      cmd: ["affiliations_stat.py","--input-biom", "../example.biom","--output-file", "affstat.out", "--tax-consensus-tag", "human gut","--multiple-tag", "blast_affiliations"]

  biomtsv: 
   image: biom_to_tsv:2.1.0
   run:
      volume: ["/root/data:/root"]
      workdir: "/root/out"
      cmd: ["biom_to_tsv.py", "-b", "../example.biom"]

  biomstd:
    image: biom_to_stdbiom:1.1.1 
    run:
      volume: ["/root/data:/root"]
      workdir: "/root/out"
      cmd: ["biom_to_stdBiom.py", "-b", "../example.biom"]

  cluster:
    image: clusters_stat:1.1.0
    run:
      volume: ["/root/data:/root"]
      workdir: "/root/out"
      cmd: ["clusters_stat.py", "-i","../example.biom","-o","example_summary.out"]

  demux: 
    image: demultiplex:1.1.0
    run:
      volume: ["/root/data:/root"]
      workdir: "/root/out"
      cmd: ["demultiplex.py", "--input-R1","../test.fastq","--input-barcode","../index.tsv"]

  filter:
    image: filters:1.2.0
    run:
      volume: ["/root/data:/root"]
      workdir: "/root/out"
      cmd: ["filters.py","--input-biom","../example.biom","--input-fasta","../db.fasta","-a","0"]

  norm:
    image: normalisation:0.6.0
    run:
      volume: ["/root/data:/root"]
      workdir: "/root/out"
      cmd: ["normalisation.py","-h"]



groups:
  test:
    - affotu
    - affstat
    - norm
  val1:
    - biomtsv
    - biomstd
    - cluster
    - demux
    - filter
hooks:
  foo:
    post-start: echo container from foo started
  bar:
    post-stop: echo container from bar stopped
